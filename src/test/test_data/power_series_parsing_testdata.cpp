#include <vector>
#include "test/test_data/power_series_parsing_testdata.hpp"

std::vector<PowerSeriesTestcase> test_cases = {
        {"1/(1-z)", {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}, false, 0},

        // fibonacci
        {"1/(1-z-z^2)", {1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765}, false, 0},
        {"SEQ(SEQ_{1, 2}(z))", {1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765}, false, 0},

        // tribonacci
        {"1/(1-z-z^2-z^3)", {1, 1, 2, 4, 7, 13, 24, 44, 81, 149}, false, 0},
        {"SEQ(SEQ_{1,2,3}(z))", {1, 1, 2, 4, 7, 13, 24, 44, 81, 149}, false, 0},

        // derangements
        {"exp(-z)/(1-z)", {1, 0, 1, 2, 9, 44, 265, 1854, 14833, 133496}, true, 0},
        {"LSET(LCYC_>1(z))", {1, 0, 1, 2, 9, 44, 265, 1854, 14833, 133496}, true, 0},

        // permutations with all cycle lengths > 2
        {"exp(-z-z^2/2)/(1-z)", {1, 0, 0, 2, 6, 24, 160, 1140, 8988, 80864}, true, 0},
        {"exp(-z^2/2-z)/(1-z)", {1, 0, 0, 2, 6, 24, 160, 1140, 8988, 80864}, true, 0},
        {"LSET(LCYC_>2(z))", {1, 0, 0, 2, 6, 24, 160, 1140, 8988, 80864}, true, 0},

        // permutations with all cycle lengths > 3
        {"exp(-z-z^2/2-z^3/3)/(1-z)", {1, 0, 0, 0, 6, 24, 120, 720, 6300, 58464, 586656, 6384960, 76471560, 994831200, 13939507296, 209097854784, 3345235180560, 56866395720960, 1023601917024000, 19448577603454464}, true, 0},
        {"exp(-(z+z^2/2+z^3/3))/(1-z)", {1, 0, 0, 0, 6, 24, 120, 720, 6300, 58464, 586656, 6384960, 76471560, 994831200, 13939507296, 209097854784, 3345235180560, 56866395720960, 1023601917024000, 19448577603454464}, true, 0},
        {"LSET(LCYC_>3(z))", {1, 0, 0, 0, 6, 24, 120, 720, 6300, 58464, 586656, 6384960, 76471560, 994831200, 13939507296, 209097854784, 3345235180560, 56866395720960, 1023601917024000, 19448577603454464}, true, 0},

        // surjections onto 5-element set
        {"(exp(z)-1)^5", {0, 0, 0, 0, 0, 120, 1800, 16800, 126000, 834120, 5103000, 29607600, 165528000, 901020120, 4809004200, 25292030400, 131542866000, 678330198120, 3474971465400, 17710714165200}, true, 0},
        {"-(1-exp(z))^5", {0, 0, 0, 0, 0, 120, 1800, 16800, 126000, 834120, 5103000, 29607600, 165528000, 901020120, 4809004200, 25292030400, 131542866000, 678330198120, 3474971465400, 17710714165200}, true, 0},
        {"SEQ_=5(LSET_>0(z))", {0, 0, 0, 0, 0, 120, 1800, 16800, 126000, 834120, 5103000, 29607600, 165528000, 901020120, 4809004200, 25292030400, 131542866000, 678330198120, 3474971465400, 17710714165200}, true, 0},

        // Set partitions/bell numbers
        {"exp(exp(z)-1)", {1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 115975, 678570, 4213597, 27644437, 190899322, 1382958545, 10480142147, 82864869804, 682076806159, 5832742205057}, true, 0},
        {"LSET(LSET_>=1(z))", {1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 115975, 678570, 4213597, 27644437, 190899322, 1382958545, 10480142147, 82864869804, 682076806159, 5832742205057}, true, 0},

        // surjections
        {"1/(2-exp(z))", {1, 1, 3, 13, 75, 541, 4683, 47293, 545835, 7087261, 102247563, 1622632573, 28091567595, 526858348381, 10641342970443, 230283190977853, 5315654681981355, 130370767029135901}, true, 0},
        {"SEQ(LSET_>0(z))", {1, 1, 3, 13, 75, 541, 4683, 47293, 545835, 7087261, 102247563, 1622632573, 28091567595, 526858348381, 10641342970443, 230283190977853, 5315654681981355, 130370767029135901}, true, 0},
        {"1/( -exp(z)+2)", {1, 1, 3, 13, 75, 541, 4683, 47293, 545835, 7087261, 102247563, 1622632573, 28091567595, 526858348381, 10641342970443, 230283190977853, 5315654681981355, 130370767029135901}, true, 0},

        // binary words with < 5 consecutive 1s
        {"(1-z^5)/(1-2*z+z^6)", {1, 2, 4, 8, 16, 31, 61, 120, 236, 464, 912, 1793, 3525, 6930, 13624, 26784, 52656, 103519, 203513, 400096, 786568, 1546352, 3040048, 5976577, 11749641, 23099186, 45411804, 89277256, 175514464, 345052351}, false, 0},

        // partitions into 1,2,3,4,5
        {"1/(1-z)*1/(1-z^2)*1/(1-z^3)*1/(1-z^4)*1/(1-z^5)", {1, 1, 2, 3, 5, 7, 10, 13, 18, 23, 30, 37, 47, 57, 70, 84, 101, 119, 141, 164, 192, 221, 255, 291, 333, 377, 427, 480, 540, 603, 674, 748, 831, 918, 1014, 1115, 1226, 1342, 1469, 1602, 1747, 1898, 2062, 2233, 2418, 2611, 2818, 3034, 3266, 3507, 3765, 4033, 4319}, false, 0},

        // Catalan numbers
        {"(1-sqrt(1-4*z))/(2*z)", {1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452, 18367353072152, 69533550916004, 263747951750360, 1002242216651368, 3814986502092304}, false, 1},

        // Involutions
        {"exp(z+z^2/2)", {1, 1, 2, 4, 10, 26, 76, 232, 764, 2620, 9496, 35696, 140152, 568504, 2390480, 10349536, 46206736, 211799312, 997313824, 4809701440}, true, 0},
        {"LSET(LCYC_<=2(z))", {1, 1, 2, 4, 10, 26, 76, 232, 764, 2620, 9496, 35696, 140152, 568504, 2390480, 10349536, 46206736, 211799312, 997313824, 4809701440}, true, 0},

        // Partitions
        {"MSET(SEQ_>=1(z))", {1, 1, 2, 3, 5, 7, 11, 15, 22, 30, 42, 56, 77, 101, 135, 176, 231, 297, 385, 490, 627, 792, 1002, 1255, 1575, 1958, 2436, 3010, 3718, 4565}, false, 0},
        {"MSET(SEQ_>0(z))", {1, 1, 2, 3, 5, 7, 11, 15, 22, 30, 42, 56, 77, 101, 135, 176, 231, 297, 385, 490, 627, 792, 1002, 1255, 1575, 1958, 2436, 3010, 3718, 4565}, false, 0},
        {"MSET(SEQ_>=4(z))", {1, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 5, 5, 7, 8, 11, 12, 16, 18, 24, 27, 34, 39, 50, 57, 70, 81, 100, 115}, false, 0},
        {"MSET(SEQ_>3(z))", {1, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 5, 5, 7, 8, 11, 12, 16, 18, 24, 27, 34, 39, 50, 57, 70, 81, 100, 115}, false, 0},

        // Strict partitions
        {"PSET(SEQ_>=1(z))", {1, 1, 1, 2, 2, 3, 4, 5, 6, 8, 10, 12, 15, 18, 22, 27, 32, 38, 46, 54, 64, 76, 89, 104, 122, 142, 165, 192, 222, 256, 296}, false, 0},
        {"PSET(SEQ_>0(z))", {1, 1, 1, 2, 2, 3, 4, 5, 6, 8, 10, 12, 15, 18, 22, 27, 32, 38, 46, 54, 64, 76, 89, 104, 122, 142, 165, 192, 222, 256, 296}, false, 0},
        {"PSET_{1,3,5,7,9,11,13,15,17,19}(SEQ_>0(z))", {0, 1, 1, 1, 1, 1, 2, 2, 3, 4, 5, 6, 8, 9, 11, 14, 16, 19, 23, 27, 32}, false, 0},

        // partitions into odd parts == strict partitions
        {"MSET(SEQ_{1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31}(z))", {1, 1, 1, 2, 2, 3, 4, 5, 6, 8, 10, 12, 15, 18, 22, 27, 32, 38, 46, 54, 64, 76, 89, 104, 122, 142, 165, 192, 222, 256, 296}, false, 0},

        // Compositions
        {"SEQ(SEQ_>=1(z))", {1, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536}, false, 0},
        {"SEQ(SEQ_>0(z))", {1, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536}, false, 0},

        // some test cases for SEQ_< and SEQ_<=
        {"SEQ_<5(z)", {1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0}, false, 0},
        {"SEQ_<=4(z)", {1, 1, 1, 1, 1, 0, 0, 0, 0 , 0, 0, 0}, false, 0},
        {"SEQ_<5(z+z^2)", {1, 1, 2, 3, 5, 7, 7, 4, 1, 0, 0, 0, 0, 0}, false, 0},

        // Partitions into at least 4 parts
        {"MSET_>=3(SEQ_>0(z))", {0, 0, 0, 1, 2, 4, 7, 11, 17, 25, 36, 50, 70, 94, 127, 168, 222, 288, 375, 480, 616, 781, 990, 1243, 1562, 1945, 2422, 2996, 3703, 4550, 5588, 6826, 8332, 10126, 12292, 14865, 17958, 21618, 25995, 31165, 37317, 44562}, false, 0},
        {"MSET_>2(SEQ_>0(z))", {0, 0, 0, 1, 2, 4, 7, 11, 17, 25, 36, 50, 70, 94, 127, 168, 222, 288, 375, 480, 616, 781, 990, 1243, 1562, 1945, 2422, 2996, 3703, 4550, 5588, 6826, 8332, 10126, 12292, 14865, 17958, 21618, 25995, 31165, 37317, 44562}, false, 0},
        {"MSET(SEQ_>0(z))-MSET_<3(SEQ_>0(z))", {0, 0, 0, 1, 2, 4, 7, 11, 17, 25, 36, 50, 70, 94, 127, 168, 222, 288, 375, 480, 616, 781, 990, 1243, 1562, 1945, 2422, 2996, 3703, 4550, 5588, 6826, 8332, 10126, 12292, 14865, 17958, 21618, 25995, 31165, 37317, 44562}, false, 0},
        {"MSET(SEQ_>0(z))-MSET_<=2(SEQ_>0(z))", {0, 0, 0, 1, 2, 4, 7, 11, 17, 25, 36, 50, 70, 94, 127, 168, 222, 288, 375, 480, 616, 781, 990, 1243, 1562, 1945, 2422, 2996, 3703, 4550, 5588, 6826, 8332, 10126, 12292, 14865, 17958, 21618, 25995, 31165, 37317, 44562}, false, 0},

        // Partitions into at most 3 parts
        {"MSET_<4(SEQ_>0(z))", {1, 1, 2, 3, 4, 5, 7, 8, 10, 12, 14, 16, 19, 21, 24, 27, 30, 33, 37, 40, 44, 48, 52, 56, 61, 65, 70, 75, 80, 85, 91, 96, 102, 108, 114, 120, 127, 133, 140, 147, 154, 161, 169, 176, 184, 192, 200, 208, 217, 225, 234, 243, 252, 261, 271, 280, 290, 300, 310, 320, 331, 341}, false, 0},
        {"MSET_<=3(SEQ_>0(z))", {1, 1, 2, 3, 4, 5, 7, 8, 10, 12, 14, 16, 19, 21, 24, 27, 30, 33, 37, 40, 44, 48, 52, 56, 61, 65, 70, 75, 80, 85, 91, 96, 102, 108, 114, 120, 127, 133, 140, 147, 154, 161, 169, 176, 184, 192, 200, 208, 217, 225, 234, 243, 252, 261, 271, 280, 290, 300, 310, 320, 331, 341}, false, 0},
        {"MSET(SEQ_>0(z))-MSET_>=4(SEQ_>0(z))", {1, 1, 2, 3, 4, 5, 7, 8, 10, 12, 14, 16, 19, 21, 24, 27, 30, 33, 37, 40, 44, 48, 52, 56, 61, 65, 70, 75, 80, 85, 91, 96, 102, 108, 114, 120, 127, 133, 140, 147, 154, 161, 169, 176, 184, 192, 200, 208, 217, 225, 234, 243, 252, 261, 271, 280, 290, 300, 310, 320, 331, 341}, false, 0},
        {"MSET(SEQ_>0(z))-MSET_>3(SEQ_>0(z))", {1, 1, 2, 3, 4, 5, 7, 8, 10, 12, 14, 16, 19, 21, 24, 27, 30, 33, 37, 40, 44, 48, 52, 56, 61, 65, 70, 75, 80, 85, 91, 96, 102, 108, 114, 120, 127, 133, 140, 147, 154, 161, 169, 176, 184, 192, 200, 208, 217, 225, 234, 243, 252, 261, 271, 280, 290, 300, 310, 320, 331, 341}, false, 0},

        // Partitions into at least 3 different parts
        {"PSET_>=3(SEQ_>0(z))", {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 5, 6, 9, 11, 15, 19, 24, 29, 37, 44, 54, 65, 78, 92, 110, 129, 152, 178, 208, 241, 281, 324, 374, 431, 495, 567, 650, 741, 845, 962, 1093, 1239, 1405, 1588, 1794, 2025, 2281, 2566, 2886, 3239, 3633, 4071, 4556, 5093, 5691, 6350, 7080, 7888, 8779, 9762, 10850}, false, 0},
        {"PSET_>2(SEQ_>0(z))",  {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 5, 6, 9, 11, 15, 19, 24, 29, 37, 44, 54, 65, 78, 92, 110, 129, 152, 178, 208, 241, 281, 324, 374, 431, 495, 567, 650, 741, 845, 962, 1093, 1239, 1405, 1588, 1794, 2025, 2281, 2566, 2886, 3239, 3633, 4071, 4556, 5093, 5691, 6350, 7080, 7888, 8779, 9762, 10850}, false, 0},
        {"PSET(SEQ_>0(z))-PSET_<=2(SEQ_>0(z))",  {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 5, 6, 9, 11, 15, 19, 24, 29, 37, 44, 54, 65, 78, 92, 110, 129, 152, 178, 208, 241, 281, 324, 374, 431, 495, 567, 650, 741, 845, 962, 1093, 1239, 1405, 1588, 1794, 2025, 2281, 2566, 2886, 3239, 3633, 4071, 4556, 5093, 5691, 6350, 7080, 7888, 8779, 9762, 10850}, false, 0},
        {"PSET(SEQ_>0(z))-PSET_<3(SEQ_>0(z))",  {0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 5, 6, 9, 11, 15, 19, 24, 29, 37, 44, 54, 65, 78, 92, 110, 129, 152, 178, 208, 241, 281, 324, 374, 431, 495, 567, 650, 741, 845, 962, 1093, 1239, 1405, 1588, 1794, 2025, 2281, 2566, 2886, 3239, 3633, 4071, 4556, 5093, 5691, 6350, 7080, 7888, 8779, 9762, 10850}, false, 0},

        // some special permutations
        {"LSET_>1(LCYC_>0(z))", {0, 0, 1, 4, 18, 96, 600, 4320, 35280, 322560, 3265920, 36288000, 439084800, 5748019200, 80951270400, 1220496076800, 19615115520000}, true, 0},
        {"LSET_<=2(LCYC(z))", {1, 1, 2, 5, 17, 74, 394, 2484, 18108, 149904, 1389456, 14257440, 160460640, 1965444480, 26029779840, 370643938560, 5646837369600, 91657072281600}, true, 0},
        {"LSET(LCYC_{1,3,5,7,9,11,13,15,17,19}(z))", {1, 1, 1, 3, 9, 45, 225, 1575, 11025, 99225, 893025, 9823275, 108056025, 1404728325, 18261468225, 273922023375, 4108830350625, 69850115960625}, true, 0},
        {"LSET(LCYC_~{2,4,6,8,10,12,14,16,18,20}(z))", {1, 1, 1, 3, 9, 45, 225, 1575, 11025, 99225, 893025, 9823275, 108056025, 1404728325, 18261468225, 273922023375, 4108830350625, 69850115960625}, true, 0},
        {"LSET(LCYC_{2,4,6,8,10,12,14,16,18,20}(z))", {1, 0, 1, 0, 9, 0, 225, 0, 11025, 0, 893025, 0, 108056025, 0, 18261468225, 0, 4108830350625, 0, 1187451971330625, 0}, true, 0},

        // alignments
        {"SEQ(LCYC(z))", {1, 1, 3, 14, 88, 694, 6578, 72792, 920904, 13109088, 207360912, 3608233056, 68495486640, 1408631978064, 31197601660080}, true, 0},
        {"1/(1+log(1-z))", {1, 1, 3, 14, 88, 694, 6578, 72792, 920904, 13109088, 207360912, 3608233056, 68495486640, 1408631978064, 31197601660080}, true, 0},

        // Stirling numbers of the first kind
        {"LSET_{5}(LCYC(z))", {0, 0, 0, 0, 0, 1, 15, 175, 1960, 22449, 269325, 3416930, 45995730, 657206836, 9957703756, 159721605680, 2706813345600, 48366009233424}, true, 0},
        {"LSET_{7}(LCYC(z))", {0, 0, 0, 0, 0, 0, 0, 1, 28, 546, 9450, 157773, 2637558, 44990231, 790943153, 14409322928, 272803210680, 5374523477960, 110228466184200}, true, 0},
        {"1/(1-z)-LSET_~{7}(LCYC(z))", {0, 0, 0, 0, 0, 0, 0, 1, 28, 546, 9450, 157773, 2637558, 44990231, 790943153, 14409322928, 272803210680, 5374523477960, 110228466184200}, true, 0},

        // Stirling numbers of the second kind (k = 5)
        {"LSET_=5(LSET_>0(z))", {0, 0, 0, 0, 0, 1, 15, 140, 1050, 6951, 42525, 246730}, true, 0},

        // necklaces/wheel compositions
        {"CYC(SEQ_>0(z))", {0, 1, 2, 3, 5, 7, 13, 19, 35, 59, 107, 187, 351, 631, 1181, 2191, 4115, 7711, 14601, 27595, 52487, 99879, 190745, 364723, 699251, 1342183, 2581427, 4971067, 9587579, 18512791, 35792567, 69273667, 134219795, 260301175, 505294127, 981706831, 1908881899, 3714566311, 7233642929}, false, 0},
        {"CYC_<=5(SEQ_>0(z))+CYC_>5(SEQ_>0(z))", {0, 1, 2, 3, 5, 7, 13, 19, 35, 59, 107, 187, 351, 631, 1181, 2191, 4115, 7711, 14601, 27595, 52487, 99879, 190745, 364723, 699251, 1342183, 2581427, 4971067, 9587579, 18512791, 35792567, 69273667, 134219795, 260301175, 505294127, 981706831, 1908881899, 3714566311, 7233642929}, false, 0},
        {"CYC_<7(SEQ_>0(z))+CYC_>=7(SEQ_>0(z))", {0, 1, 2, 3, 5, 7, 13, 19, 35, 59, 107, 187, 351, 631, 1181, 2191, 4115, 7711, 14601, 27595, 52487, 99879, 190745, 364723, 699251, 1342183, 2581427, 4971067, 9587579, 18512791, 35792567, 69273667, 134219795, 260301175, 505294127, 981706831, 1908881899, 3714566311, 7233642929}, false, 0},

        // necklaces with 3 colors
        {"CYC(3*z)", {0, 3, 6, 11, 24, 51, 130, 315, 834, 2195, 5934, 16107, 44368, 122643, 341802, 956635, 2690844, 7596483, 21524542, 61171659, 174342216, 498112275, 1426419858, 4093181691}, false, 0},

        // some evals
        {"eval(1/(1-z), 2*z)", {1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384}, false, 0},
        {"eval(1/(1-z), z/(1-z)+O(z^60))", {1, 1, 2, 4, 8, 16, 32, 64, 128, 256}, false, 0},
        {"eval(exp(z), z/(1-z))", {1, 1, 3, 13, 73, 501, 4051, 37633}, true, 0},
        {"eval(exp(z), z/(1-z)+O(z^20))", {1, 1, 3, 13, 73, 501, 4051, 37633, 394353, 4596553, 58941091}, true, 0},
        {"eval(1/(1-z), CYC(3*z))", {1, 3, 15, 74, 369, 1839, 9188, 45903, 229425, 1146758}, false, 0},

        // trigonometric functions
        {"cos(z+z^2)", {1, 0, -1, -6, -11, 20, 179, 798, 841, -10008, -73081}, true, 0},
        {"sin(z+z^2)", {0, 1, 2, -1, -12, -59, -90, 419, 3304, 13609, 5130}, true, 0},
        {"sin(z)^2+cos(z)^2", {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, false, 0},
        {"sin(z+z^3)^2+cos(z+z^3)^2", {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, false, 0},
        {"tan(z)-sin(z)/cos(z)", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, false, 0},
        {"tan(exp(z)-1)-sin(exp(z)-1)/cos(exp(z)-1)", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, false, 0},
};

const std::vector<PowerSeriesTestcase>& get_power_series_parsing_test_cases() {
    return test_cases;
}
